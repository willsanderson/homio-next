hom_entity:
  template:
    - hom_default
  class: hom-entity
  show_state: true
  show_entity_picture: true

  entity_picture: |
    [[[
      const icon = variables.icon || "default";
      return `/local/hom/icons/${icon}.svg`;
    ]]]

  state_display: |
    [[[
      if (!entity.state) return "";
      if (entity.state === "ok") return "Healthy";
      return entity.state.charAt(0).toUpperCase() + entity.state.slice(1);
    ]]]

  state:
    - operator: template
      value: |
        [[[
          const s = (entity?.state || "").toLowerCase();
          return ["on","playing","unlocked","cleaning","cool","heat"].includes(s);
        ]]]
      styles:
        card:
          - background: var(--ha-card-background-active)
          - box-shadow: var(--button-card-box-shadow-active, var(--button-card-box-shadow)) !important
        name:
          - color: var(--hom-entity-active, var(--primary-text-color))
        state:
          - color: var(--secondary-text-color)
        icon:
          - color: var(--hom-entity-active, var(--primary-text-color))
        img_cell:
          - opacity: var(--hom-entity-picture-active-opacity, 1) !important
          - filter: var(--hom-entity-picture-active-filter, none) !important
        entity_picture:
          - opacity: var(--hom-entity-picture-active-opacity, 1) !important
          - filter: var(--hom-entity-picture-active-filter, none) !important

  styles:
    card:
      - background: var(--ha-card-background)
      - backdrop-filter: blur(14px)
      - border-radius: var(--ha-card-border-radius, 30px)
      - position: relative
      - height: |
          [[[
            const isMobile = window.innerWidth <= 768;
            return isMobile
              ? 'var(--hom-entity-height-mobile, 120px)'
              : 'var(--hom-entity-height-desktop, 180px)';
          ]]]
      - padding-left: |
          [[[
            const isMobile = window.innerWidth <= 768;
            return isMobile
              ? 'var(--hom-entity-padding-mobile, 20px)'
              : 'var(--hom-entity-padding-desktop, 32px)';
          ]]]
      - padding-right: |
          [[[
            const isMobile = window.innerWidth <= 768;
            return isMobile
              ? 'var(--hom-entity-padding-mobile, 20px)'
              : 'var(--hom-entity-padding-desktop, 32px)';
          ]]]
      - padding-top: 8px
      - padding-bottom: 8px
      - scroll-snap-align: start
      - display: |
          [[[
            return (states['input_boolean.hom_mobile_navigation'].state === 'on') ? 'none' : 'block';
          ]]]
      - --ha-card-border-width: 0
      - transition: background-color .22s ease,
                    box-shadow .24s ease,
                    transform .14s ease,
                    filter .18s ease

    name:
      - color: var(--hom-entity-inactive, var(--secondary-text-color)) !important
      - font-weight: 600
      - text-shadow: var(--hom-entity-text-shadow, 0 0 3px rgba(0, 0, 0, 0.3))
      - justify-self: start
      - margin-bottom: 5px
      - font-size: |
          [[[
            const isMobile = window.innerWidth <= 768;
            return isMobile
              ? 'var(--hom-entity-name-font-mobile, 15px)'
              : 'var(--hom-entity-name-font-desktop, 16px)';
          ]]]
      - line-height: 1.2
      - white-space: nowrap
      - overflow: hidden
      - text-overflow: ellipsis
      - transition: color .18s ease, opacity .18s ease

    state:
      - text-transform: capitalize
      - color: var(--hom-entity-inactive, var(--secondary-text-color)) !important
      - font-size: |
          [[[
            const isMobile = window.innerWidth <= 768;
            return isMobile
              ? 'var(--hom-entity-state-font-mobile, 13px)'
              : 'var(--hom-entity-state-font-desktop, 14px)';
          ]]]
      - text-shadow: var(--hom-entity-text-shadow, 0 0 3px rgba(0, 0, 0, 0.3))
      - justify-self: start
      - font-weight: 700
      - opacity: 0.85
      - line-height: 1.2
      - transition: color .18s ease, opacity .18s ease

    grid:
      - grid-template-columns: minmax(0, 1fr) min-content
      - grid-column-gap: |
          [[[
            return (window.innerWidth <= 768) ? '14px' : '20px';
          ]]]
      - grid-template-rows: min-content
      - grid-template-areas: '"n i" "s i"'
      - place-content: center

    img_cell:
      - color: var(--hom-entity-inactive, var(--secondary-text-color)) !important
      - width: |
          [[[
            return (window.innerWidth <= 768) ? '28px' : '30px';
          ]]]
      - height: |
          [[[
            return (window.innerWidth <= 768) ? '28px' : '30px';
          ]]]
      - background: transparent
      - transition: opacity .18s ease, filter .18s ease

    entity_picture:
      - opacity: var(--hom-entity-picture-inactive-opacity, .9)
      - filter: var(--hom-entity-picture-inactive-filter, brightness(.9))
      - transition: opacity .18s ease, filter .18s ease

    icon:
      - color: var(--hom-entity-inactive, var(--secondary-text-color)) !important
      - width: 100%
      - height: 100%
